{{ $url := .Get "url" }}
{{ $text := .Get "text" }}
{{ $user_id := .Get "user" }}
{{ $image_path := .Get "image" }}
{{ $display_name := .Get "display" | default $user_id }}

{{/* Lista de extensões suportadas */}}
{{ $extensions := slice ".jpg" ".jpeg" ".png" ".gif" ".webp" ".bmp" ".tiff" }}

{{/* Se não foi fornecido um caminho específico, procurar a imagem */}}
{{ if not $image_path }}
  {{ $image_found := false }}
  {{ range $ext := $extensions }}
    {{ $possible_path := printf "/images/team/%s%s" $user_id $ext }}
    {{ if fileExists (printf "static%s" $possible_path) }}
      {{ $image_path = $possible_path }}
      {{ $image_found = true }}
      {{ break }}
    {{ end }}
  {{ end }}
  
  {{/* Se não encontrou nenhuma imagem, usar placeholder */}}
  {{ if not $image_found }}
    {{ $image_path = "/images/team/placeholder.png" }}
  {{ end }}
{{ end }}

<span class="hover-link-simple">
  <a href="{{ $url }}">{{ $text }}</a>
  <div class="hover-image">
    <img src="{{ $image_path }}" alt="{{ $display_name }}" 
         onerror="this.src='/images/team/placeholder.png'">
    <span>{{ $display_name }}</span>
  </div>
</span>

<style>
  .hover-link-simple {
  position: relative;
  display: inline-block;
}

.hover-link-simple .hover-image {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
  min-width: 150px;
  text-align: center;
}

.hover-link-simple:hover .hover-image {
  opacity: 1;
  visibility: visible;
}

.hover-link-simple .hover-image img {
  width: 120px;
  height: 120px;
  object-fit: cover;
  border-radius: 50%;
  margin-bottom: 5px;
}

.hover-link-simple .hover-image span {
  font-size: 0.8em;
  color: #666;
  display: block;
}
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
  const hoverContainers = document.querySelectorAll('.hover-link-simple');
  
  const extensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.bmp', '.tiff'];
  
  hoverContainers.forEach(container => {
    const img = container.querySelector('img');
    const basePath = img.getAttribute('data-base-path');
    
    if (basePath) {
      // Tentar carregar a imagem com diferentes extensões
      let imageLoaded = false;
      
      extensions.forEach(ext => {
        if (!imageLoaded) {
          const testImage = new Image();
          testImage.src = basePath + ext;
          testImage.onload = function() {
            if (!imageLoaded) {
              img.src = basePath + ext;
              imageLoaded = true;
            }
          };
        }
      });
      
      // Se nenhuma imagem carregar após um tempo, usar placeholder
      setTimeout(() => {
        if (!imageLoaded) {
          img.src = '/images/team/placeholder.png';
        }
      }, 100);
    }
  });
});
</script>