<!-- PORTUGUÊS --> 
{{ if eq .Site.Language.Lang "pt" }}
  {{ with .Site.Data.team }}
    {{ if .enable }}
    <section class="site-team">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <div class="section-title">
              <h2>
                {{ .title }}
              </h2>
            </div>
                 
            <!-- Filtros combinados -->
            <div class="row justify-content-center mb-4">
              <div class="col-md-5">
                <div class="status-filter mb-3">
                  <label for="status-select" class="form-label">Filtrar por status:</label>
                  <select id="status-select" class="form-select">
                    {{ $activeCount := 0 }}
                    {{ $inactiveCount := 0 }}
                    {{ $totalCount := 0 }}
                    
                    <!-- Calcular contadores -->
                    {{ range .members }}
                      {{ $status := default "ATIVO" .status | upper }}
                      {{ $totalCount = add $totalCount 1 }}
                      {{ if eq $status "ATIVO" }}
                        {{ $activeCount = add $activeCount 1 }}
                      {{ else if eq $status "INATIVO" }}
                        {{ $inactiveCount = add $inactiveCount 1 }}
                      {{ end }}
                    {{ end }}
                    
                    <option value="ativo" selected>Atuais ({{ $activeCount }})</option>
                    <option value="inativo">Ex-membros ({{ $inactiveCount }})</option>
                    <option value="all">Todos ({{ $totalCount }})</option>
                  </select>
                </div>
              </div>
              <div class="col-md-5">
                <div class="interest-filter">
                  <label for="interest-select" class="form-label">Filtrar por área de interesse:</label>
                  <select id="interest-select" class="form-select">
                    <option value="all">Todas as áreas</option>
                    {{ $allInterests := slice }}
                    {{ range .members }}
                      {{ if .interesse }}
                        {{ if reflect.IsSlice .interesse }}
                          {{ $allInterests = $allInterests | append .interesse }}
                        {{ else }}
                          <!-- Se for string, converta para slice -->
                          {{ $allInterests = $allInterests | append (slice .interesse) }}
                        {{ end }}
                      {{ end }}
                    {{ end }}
                    
                    {{ $uniqueInterests := slice }}
                    {{ $interestCounts := dict }}
                    {{ range $allInterests }}
                      {{ if reflect.IsSlice . }}
                        {{ range . }}
                          {{ $interest := . | string }}
                          {{ if not (in $uniqueInterests $interest) }}
                            {{ $uniqueInterests = $uniqueInterests | append $interest }}
                            {{ $interestCounts = merge $interestCounts (dict $interest 1) }}
                          {{ else }}
                            {{ $currentCount := index $interestCounts $interest | default 0 }}
                            {{ $interestCounts = merge $interestCounts (dict $interest (add $currentCount 1)) }}
                          {{ end }}
                        {{ end }}
                      {{ else }}
                        {{ $interest := . | string }}
                        {{ if not (in $uniqueInterests $interest) }}
                          {{ $uniqueInterests = $uniqueInterests | append $interest }}
                          {{ $interestCounts = merge $interestCounts (dict $interest 1) }}
                        {{ else }}
                          {{ $currentCount := index $interestCounts $interest | default 0 }}
                          {{ $interestCounts = merge $interestCounts (dict $interest (add $currentCount 1)) }}
                        {{ end }}
                      {{ end }}
                    {{ end }}
                    
                    {{ range sort $uniqueInterests }}
                    <option value="{{ . | urlize }}">{{ . }} ({{ index $interestCounts . }})</option>
                    {{ end }}
                  </select>
                </div>
              </div>
            </div>
          </div>
          
          {{ range .members }}
          {{ $memberStatus := default "ATIVO" .status | lower }}
          <div class="col-lg-6 col-md-6 team-member" 
               data-interests="{{ if .interesse }}{{ if reflect.IsSlice .interesse }}{{ range .interesse }}{{ . | urlize }} {{ end }}{{ else }}{{ .interesse | urlize }}{{ end }}{{ end }}"
               data-status="{{ $memberStatus }}">
            <div class="site-team-member {{ if eq $memberStatus "inativo" }}inactive-member{{ end }}">
              <div class="site-team-member-image">
                <img src="{{ .image | absURL }}" alt="team-member" id="{{ .name | urlize }}">
              </div>
              <div class="site-team-member-content" id="{{ .name | urlize }}">
                <h3>{{ .name }}
                  <span class="status-indicator status-{{ $memberStatus }}">
                    {{ if eq $memberStatus "ativo" }}✓{{ else }}●{{ end }}
                  </span>
                </h3>
                <p>{{ .designation }}</p>
                {{ if .company_position }}<p><strong>{{ if ne .company_position "Professor Tutor PET" }}Time:{{ end }}</strong> {{ .company_position }}</p>{{ end }}
                
                <p class="site-team-item-body">
                  {{ if .quote }}<blockquote>{{ .quote }}</blockquote>{{ end }}
                </p>
                {{ if .interesse }}
                  <p><strong>Áreas de interesse:</strong> 
                    {{ if reflect.IsSlice .interesse }}
                      {{ delimit .interesse ", " }}
                    {{ else }}
                      {{ .interesse }}
                    {{ end }}
                  </p>
                {{ end }}
                <ul class="site-team-member-social">
                  {{ if .github }}<li><a href="{{ .github | absURL }}"><i class="fa fa-github"></i></a></li>{{ end }}
                  {{ if .linkedin }}<li><a href="{{ .linkedin | absURL }}"><i class="fa fa-linkedin"></i></a></li>{{ end }}
                  {{ if .instagram }}<li><a href="{{ .instagram | absURL }}"><i class="fa fa-instagram" style="font-size:15px"></i></a></li>{{ end }}
                  {{ if .site }}<li><a href="{{ .site | absURL }}"><i class="fa fa-globe" style="font-size:15px"></i></a></li>{{ end }}
                </ul>
              </div>
                <!-- Mostrar data de saída para membros inativos -->
                {{ if and (eq $memberStatus "inativo") .saida }}
                <p class="departure-date">
                  <strong>Saída:</strong> {{ .saida }}
                </p>
                {{ end }}           
            </div>
          </div>
          {{ end }}
        </div>
      </div>
    </section>

    <!-- Script para os filtros -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const interestSelect = document.getElementById('interest-select');
      const statusSelect = document.getElementById('status-select');
      const teamMembers = document.querySelectorAll('.team-member');
      
      // Função para aplicar ambos os filtros
      function applyFilters() {
        const selectedInterest = interestSelect.value;
        const selectedStatus = statusSelect.value;
        
        teamMembers.forEach(member => {
          const memberInterests = member.getAttribute('data-interests').split(' ');
          const memberStatus = member.getAttribute('data-status');
          
          // Filtro por interesse
          let interestMatch = selectedInterest === 'all' || memberInterests.includes(selectedInterest);
          
          // Filtro por status
          let statusMatch = selectedStatus === 'all' || memberStatus === selectedStatus;
          
          // Mostrar apenas se ambos os filtros forem satisfeitos
          if (interestMatch && statusMatch) {
            member.style.display = 'block';
          } else {
            member.style.display = 'none';
          }
        });
      }
      
      // Event listeners para ambos os filtros
      interestSelect.addEventListener('change', applyFilters);
      statusSelect.addEventListener('change', applyFilters);
      
      // Aplicar filtros inicialmente
      applyFilters();
    });
    </script>
    
    <style>
  /* Estilo para a data de saída dos membros inativos */
  .departure-date {
    color: #6c757d;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
    padding: 3px 8px;
    background-color: rgba(108, 117, 125, 0.1);
    border-radius: 4px;
    display: inline-block;
  }
  
  .inactive-member .departure-date {
    background-color: rgba(108, 117, 125, 0.15);
  }		
  .form-select {
    display: block;
    width: 100%;
    padding: 0.375rem 2.25rem 0.375rem 0.75rem;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    color: #212529;
    background-color: #fff;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 16px 12px;
    border: 1px solid #ced4da;
    border-radius: 0.375rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    appearance: none;
  }

  .form-select:focus {
    border-color: #86b7fe;
    outline: 0;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
  }

  .form-select:disabled {
    background-color: #e9ecef;
    opacity: 1;
  }

  /* Tamanhos diferentes como no Bootstrap */
  .form-select-sm {
    padding: 0.25rem 2rem 0.25rem 0.5rem;
    font-size: 0.875rem;
    border-radius: 0.25rem;
  }

  .form-select-lg {
    padding: 0.5rem 2.5rem 0.5rem 1rem;
    font-size: 1.25rem;
    border-radius: 0.5rem;
  }

  /* Estados de validação */
  .form-select.is-valid {
    border-color: #198754;
  }

  .form-select.is-valid:focus {
    border-color: #198754;
    box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25);
  }

  .form-select.is-invalid {
    border-color: #dc3545;
  }

  .form-select.is-invalid:focus {
    border-color: #dc3545;
    box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
  }

  @supports (-webkit-appearance: none) or (-moz-appearance: none) {
    .form-select {
      -webkit-appearance: none;
      -moz-appearance: none;
    }
  }
  
  .status-counters {
    font-size: 1.1rem;
  }
  
  .status-counters .badge {
    font-size: 1rem;
    padding: 0.5rem 0.75rem;
  }
  
  .status-filter,
  .interest-filter {
    margin-bottom: 1rem;
  }
  
  .team-member {
    transition: all 0.3s ease;
  }
  
  .team-member[style*="display: none"] {
    opacity: 0;
    height: 0;
    overflow: hidden;
    margin: 0;
    padding: 0;
  }
  
  /* Estilo para membros inativos - mais escuro */
  .inactive-member {
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }
  
  .inactive-member .site-team-member-content {
    opacity: 0.8;
  }
  
  .inactive-member h3 {
    color: #6c757d;
  }
  
  .inactive-member .site-team-member-image img {
    filter: grayscale(30%);
  }
  
  /* Indicador de status ao lado do nome */
  .status-indicator {
    font-size: 0.8rem;
    margin-left: 8px;
    vertical-align: middle;
  }
  
  .status-ativo .status-indicator {
    color: #28a745;
  }
  
  .status-inativo .status-indicator {
    color: #6c757d;
  }
    </style>
    {{ end }}
  {{ end }}
{{ end }}
