{{ define "main" }}
  {{ $dataParts := split .Params.prazo "/" }}
  {{ $dia := index $dataParts 0 }}
  {{ $mes := index $dataParts 1 }}
  {{ $ano := index $dataParts 2 }}
  {{ $prazoStr := printf "%s-%s-%s" $ano $mes $dia }}
  {{ $prazo := time $prazoStr }}
  {{ $hoje := now }}
  {{ $encerrado := $hoje.After $prazo }}

  <article class="processo-detalhes container">
    <div class="row justify-content-center">
      <div class="col-lg-10 col-xl-8">
        <div class="processo-detalhes-header text-center mb-4">
          <div class="site-about-espaco"></div>
          
          <!-- Banner de retificação -->
          {{ if .Params.retificado }}
            <div class="alert alert-warning alert-dismissible fade show mb-4" role="alert">
              <i class="bi bi-exclamation-triangle-fill me-2"></i>
              <strong>ATENÇÃO:</strong> Este edital foi retificado e sofreu alterações. Verifique os detalhes atualizados no arquivo do edital.
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
              </button>

            </div>
          {{ end }}
          
          <h1 class="mb-3">{{ .Title }}</h1>
          
          {{ if .Params.imagem }}
            <div class="processo-imagem img-fluid mb-4">
              <img src="{{ .Params.imagem }}" 
                   alt="{{ .Title }}" 
                   class="img-fluid rounded shadow-sm"
                   loading="lazy"
                   style="max-height: 300px; object-fit: contain;">
            </div>
          {{ end }}
          
          <div class="processo-prazo badge {{ if $encerrado }}bg-danger{{ else }}bg-primary{{ end }} text-white mb-4">
            <i class="bi bi-calendar-event me-2"></i>
            {{ if $encerrado }}
              Processo encerrado ({{ .Params.prazo }})
            {{ else }}
              Finaliza em: {{ .Params.prazo }}
            {{ end }}
          </div>
        </div>

        <div class="processo-detalhes-content bg-white p-4 p-md-5 rounded shadow-sm mb-4">
          {{ .Content | replaceRE "<table>" "<div class='table-responsive'><table class='table table-striped table-hover'>" | replaceRE "</table>" "</table></div>" | safeHTML }}
          
          <style>
            .processo-detalhes-content table {
              width: 100%;
              border-collapse: collapse;
              margin: 1.5rem 0;
              font-size: 0.95rem;
            }
            .processo-detalhes-content table th {
              background-color: #f8f9fa;
              font-weight: 600;
              text-align: left;
              padding: 12px 15px;
              border-bottom: 2px solid #dee2e6;
            }
            .processo-detalhes-content table td {
              padding: 10px 15px;
              border-bottom: 1px solid #dee2e6;
              vertical-align: top;
            }
            .processo-detalhes-content table tr:last-child td {
              border-bottom: none;
            }
            .processo-detalhes-content table tr:hover td {
              background-color: #f1f3f5;
            }
            @media (max-width: 768px) {
              .processo-detalhes-content table {
                font-size: 0.85rem;
              }
              .processo-detalhes-content table th, 
              .processo-detalhes-content table td {
                padding: 8px 10px;
              }
            }
          </style>
        </div>

        <a href="/processos" class="processo-detalhes-back d-inline-flex align-items-center text-decoration-none">
          <i class="bi bi-arrow-left me-2"></i>
          Voltar para a lista
        </a>
      </div>
    </div>
  </article>
{{ end }}